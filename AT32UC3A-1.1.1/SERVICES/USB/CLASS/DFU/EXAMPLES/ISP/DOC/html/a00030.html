<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>AVR32 - USB DFU Example: ISP: usb_dfu.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1-p1 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>usb_dfu.c File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Management of the USB device firmware upgrade. 
<p>
This file manages the USB device firmware upgrade.<p>
<ul>
<li>Compiler: IAR EWAVR32 and GNU GCC for AVR32</li><li>Supported devices: All AVR32 devices with a USB module can be used.</li><li>AppNote:</li></ul>
<p>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Atmel Corporation: <a href="http://www.atmel.com">http://www.atmel.com</a> <br>
 Support and FAQ: <a href="http://support.atmel.no/">http://support.atmel.no/</a> </dd></dl>

<p>
Definition in file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
<code>#include &quot;<a class="el" href="a00044.html">conf_usb.h</a>&quot;</code><br>
<code>#include &lt;avr32/io.h&gt;</code><br>
<code>#include &lt;stddef.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>
<code>#include &quot;compiler.h&quot;</code><br>
<code>#include &quot;pm.h&quot;</code><br>
<code>#include &quot;<a class="el" href="a00046.html">flashc.h</a>&quot;</code><br>
<code>#include &quot;usb_drv.h&quot;</code><br>
<code>#include &quot;usb_task.h&quot;</code><br>
<code>#include &quot;<a class="el" href="a00054.html">usb_descriptors.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="a00056.html">usb_dfu.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="a00041.html">boot.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="a00043.html">conf_isp.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="a00050.html">isp.h</a>&quot;</code><br>

<p>
<a href="a00055.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">union &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00001.html">address_t</a></td></tr>

<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#de21f96609d5cf42318df9b16c4ced73">CMD_BLANK_CHECK</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#73d541696536a935eec42edc03359e96">CMD_ERASE</a>&nbsp;&nbsp;&nbsp;0x00</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#7cab61d2d864b9953bfe36de80bb6f01">CMD_ERASE_ARG_CHIP</a>&nbsp;&nbsp;&nbsp;0xFF</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#eb26fb98af27b1b6124e6d4b04441776">CMD_GRP_DNLOAD</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#6440653aacc649380510aa31830f3ad5">CMD_GRP_EXEC</a>&nbsp;&nbsp;&nbsp;0x04</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#1e1b93df0559e425c04f4d4ca2920753">CMD_GRP_SELECT</a>&nbsp;&nbsp;&nbsp;0x06</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#3e7061dc18462050457e33662f885f63">CMD_GRP_UPLOAD</a>&nbsp;&nbsp;&nbsp;0x03</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#98292ffceeb8fd22e929fe412223a6a4">CMD_PROGRAM_START</a>&nbsp;&nbsp;&nbsp;0x00</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#929b607d33ea7317ece0130f4bd7dea9">CMD_READ_MEMORY</a>&nbsp;&nbsp;&nbsp;0x00</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#91718c9f4c48630faceac10d005cbce6">CMD_SELECT_MEMORY</a>&nbsp;&nbsp;&nbsp;0x03</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#786167bf73a3c317633a5a89a734b13e">CMD_SELECT_MEMORY_ARG_PAGE</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#e2c20d9b274a70e96b297cbdc901fa02">CMD_SELECT_MEMORY_ARG_UNIT</a>&nbsp;&nbsp;&nbsp;0x00</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#9718c80eab4acb4586586415eb040a13">CMD_START_APPLI</a>&nbsp;&nbsp;&nbsp;0x03</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#fd8d379083e82679309bbf8e7248a581">CMD_START_APPLI_ARG_NO_RESET</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#0da96ca4396e799943d1a84adb3980ea">CMD_START_APPLI_ARG_RESET</a>&nbsp;&nbsp;&nbsp;0x00</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#56020df3bb796fc06d6ed56185b56cff">ISP_ID0_ADDRESS</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#3749e16d048acfa0fbb70090416a5023">ISP_ID1_ADDRESS</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#34a53d91f166e0a028cdbde481a7bc99">ISP_INF_ITEM_COUNT</a>&nbsp;&nbsp;&nbsp;(ISP_ID1_ADDRESS + 1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#3a987c8b4b927f14dd17a51e048b296c">ISP_VERSION_ADDRESS</a>&nbsp;&nbsp;&nbsp;0x00</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#7312bc7c0f3695bff0b7fbc15dbb37f8">MEM_BOOTLOADER</a>&nbsp;&nbsp;&nbsp;0x04</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#4d3c302c0479b8044fefd249ddd501d0">MEM_CONFIGURATION</a>&nbsp;&nbsp;&nbsp;0x03</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#f9aa07058fa68e55a307388ac38395cc">MEM_COUNT</a>&nbsp;&nbsp;&nbsp;(MEM_USER + 1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#a9997d933806a6fb207fb55930432a00">MEM_EEPROM</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#797e277b6bad54cbefc14fe6a4ef0605">MEM_FLASH</a>&nbsp;&nbsp;&nbsp;0x00</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#f82d999ce5fc205a187090bfbefef388">MEM_SECURITY</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#81160b040a07265ec9ea9ade3480c135">MEM_SIGNATURE</a>&nbsp;&nbsp;&nbsp;0x05</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#1168f49bb6b4954943fba4baa4a6ea8f">MEM_USER</a>&nbsp;&nbsp;&nbsp;0x06</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#42a78d1bbe8651f134eea6e179737a41">PRODUCT_FAMILY_ID_ADDRESS</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#e38961fa867d62efaf9fd7b35a6c9831">PRODUCT_ID_ADDRESS</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#88290f7ab3a58886effc1e79bd672b95">PRODUCT_INF_ITEM_COUNT</a>&nbsp;&nbsp;&nbsp;(PRODUCT_REVISION_ADDRESS + 1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#16808bee8d0f6af23eeb063a1f4bc6d7">PRODUCT_MANUFACTURER_ID_ADDRESS</a>&nbsp;&nbsp;&nbsp;0x00</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#6bcaecfc51c7d24e73cfecb15dbfbeaa">PRODUCT_REVISION_ADDRESS</a>&nbsp;&nbsp;&nbsp;0x03</td></tr>

<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#24f4dca5bd54b71cf42ade71d6fda1a2">dfu_format_dfu_to_mcu_data</a>(width, data)&nbsp;&nbsp;&nbsp;((TPASTE2(U, width))(data))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#0630af06c966e3a0cca52d416ed09df0">Dfu_format_dfu_to_mcu_data</a>(width, data)&nbsp;&nbsp;&nbsp;((TPASTE2(U, width))(data))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#7a1cd9007045ae21acde0b48f7bdd9af">dfu_format_mcu_to_dfu_data</a>(width, data)&nbsp;&nbsp;&nbsp;((TPASTE2(U, width))(data))</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#b4fccfecd518189c1a46925fdf1a0dbc">Dfu_format_mcu_to_dfu_data</a>(width, data)&nbsp;&nbsp;&nbsp;((TPASTE2(U, width))(data))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert 16-, 32- or 64-bit data between MCU and Atmel-DFU endianisms.  <a href="#b4fccfecd518189c1a46925fdf1a0dbc"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#d2e5148ff309825eba2285d628fd92b7">erase_check_mem</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#5d28db34d36ff3888f49976e45f9ebd1">force_isp</a> (Bool force)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static Bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#10c0d82cffcef9ae75dc19306f167309">get_and_check_mem_range</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static Bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#bcae11a444dc30fdffd0e82a22af2fc7">is_isp_forced</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#d3479543c39793699024e1757f5e24c6">mem_bootloader_read</a> (void *dst, U32 src, size_t nbytes)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#0499a12792a9df3141d901a8993b9d5e">mem_configuration_read</a> (void *dst, U32 src, size_t nbytes)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#dd1519ac9a460afbbdf2f440618c3d94">mem_configuration_write</a> (U32 dst, const void *src, size_t nbytes)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#c481cf3f3240ebcf8ad2ebd2f25ea6a9">mem_flash_read</a> (void *dst, U32 src, size_t nbytes)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#a5e72de95c2eaebc50e90097f7a517aa">mem_flash_write</a> (U32 dst, const void *src, size_t nbytes)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#4c792a0bd2076acf4634e57681c1bb0c">mem_security_read</a> (void *dst, U32 src, size_t nbytes)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#74a43f1070ea11f921ad79c6630bb4b8">mem_security_write</a> (U32 dst, const void *src, size_t nbytes)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#2e54669ffd957a372461d6f276335a54">mem_signature_read</a> (void *dst, U32 src, size_t nbytes)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#63a7ddfd58667d72f478b3b05f1297a4">mem_user_read</a> (void *dst, U32 src, size_t nbytes)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#21199eac84376d68001dd00cecf691b2">mem_user_write</a> (U32 dst, const void *src, size_t nbytes)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#c47b9a242f66117db14205a3d75b6c0c">read_mem</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">Bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#15eaa33f32d6fde4ea8ba7e408b9492a">usb_dfu_dnload</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Management of the DFU_DNLOAD requests.  <a href="#15eaa33f32d6fde4ea8ba7e408b9492a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#62dbc4daf5f5254dc94c0b1c00ae1979">usb_dfu_init</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#4ea17de3f3e93df51ea8f68aa9ca5f9f">usb_dfu_stop</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">Bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#e699cfe7ed5c0b528f080d5e056a1503">usb_dfu_upload</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Management of the DFU_UPLOAD requests.  <a href="#e699cfe7ed5c0b528f080d5e056a1503"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#d32db56ce57a924629571ebbb28066f0">write_mem</a> (void)</td></tr>

<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static U8&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#4f661e7cb6f9a5ded3ac456d0ab7d319">cmd</a> = CMD_START_APPLI</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static U8&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#10507ab3bbf2da5fef97e2c2d55a1bef">cmd_group</a> = CMD_GRP_EXEC</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static U32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#0aa37fb76bd78e4b768975044d4e5eac">data_bytes</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static U8&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#80a3547e13a5115ed61c1e6001bddb35">dfu_frame</a> [DFU_FRAME_LENGTH]</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static U8&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#72b5d479cbc5c21ca31a3b96d758385f">dfu_status</a> = STATUS_OK</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="a00001.html">address_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#52058289997b205a29f0908602c345ec">end_address</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const U8&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#3313a5dc7ce36317cfeb9d5231b22a5e">ISP_INF</a> [ISP_INF_ITEM_COUNT]</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static S32&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#2f00e80c587129859a23d409c849cb9d">length</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static U8&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#374fbbe1cfcd927515a99f5cdfc3dee7">memory</a> = MEM_FLASH</td></tr>

<tr><td class="memItemLeft" nowrap>struct {</td></tr>

<tr><td class="memItemLeft" nowrap>&nbsp;&nbsp;&nbsp;void(*&nbsp;&nbsp;&nbsp;<a class="el" href="a00030.html#2ee0f257169fa94a36a103b84afa7101">read</a> )(void *dst, U32 src, size_t nbytes)</td></tr>

<tr><td class="memItemLeft" nowrap>&nbsp;&nbsp;&nbsp;void(*&nbsp;&nbsp;&nbsp;<a class="el" href="a00030.html#76c4ac28168870c768186fd58667751c">write</a> )(U32 dst, const void *src, size_t nbytes)</td></tr>

<tr><td class="memItemLeft" nowrap valign="top">}&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#25bcfc8e0357e922449012b0d41e30c7">MEMORY_ACCESS</a> [MEM_COUNT]</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="a00001.html">address_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#fa623b1048e8537f6aa02080171aea63">MEMORY_END_ADDRESS</a> [MEM_COUNT]</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static const U8&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#28dba1152c71ba300f1583f994d66682">MEMORY_ERASE_VALUE</a> [MEM_COUNT]</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static U8&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#52ebe39948f0519a749b834767124cad">PRODUCT_INF</a> [PRODUCT_INF_ITEM_COUNT]</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static Bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#2361500f6c05783fa72cb2054c93e3f0">security_active</a> = TRUE</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static <a class="el" href="a00001.html">address_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">U8&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#ab5b7c0a4e01dcfaa3985722d933afbe">usb_dfu_state</a> = STATE_dfuIDLE</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">U8&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00030.html#dab58f74f165f09a20d44012d0e5b701">usb_dfu_status</a> = STATUS_OK</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="de21f96609d5cf42318df9b16c4ced73"></a><!-- doxytag: member="usb_dfu.c::CMD_BLANK_CHECK" ref="de21f96609d5cf42318df9b16c4ced73" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_BLANK_CHECK&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00100">100</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>, and <a class="el" href="a00055.html#l00721">usb_dfu_upload()</a>.
</div>
</div><p>
<a class="anchor" name="73d541696536a935eec42edc03359e96"></a><!-- doxytag: member="usb_dfu.c::CMD_ERASE" ref="73d541696536a935eec42edc03359e96" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_ERASE&nbsp;&nbsp;&nbsp;0x00          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00103">103</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="7cab61d2d864b9953bfe36de80bb6f01"></a><!-- doxytag: member="usb_dfu.c::CMD_ERASE_ARG_CHIP" ref="7cab61d2d864b9953bfe36de80bb6f01" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_ERASE_ARG_CHIP&nbsp;&nbsp;&nbsp;0xFF          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00110">110</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="eb26fb98af27b1b6124e6d4b04441776"></a><!-- doxytag: member="usb_dfu.c::CMD_GRP_DNLOAD" ref="eb26fb98af27b1b6124e6d4b04441776" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_GRP_DNLOAD&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00090">90</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="6440653aacc649380510aa31830f3ad5"></a><!-- doxytag: member="usb_dfu.c::CMD_GRP_EXEC" ref="6440653aacc649380510aa31830f3ad5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_GRP_EXEC&nbsp;&nbsp;&nbsp;0x04          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00092">92</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="1e1b93df0559e425c04f4d4ca2920753"></a><!-- doxytag: member="usb_dfu.c::CMD_GRP_SELECT" ref="1e1b93df0559e425c04f4d4ca2920753" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_GRP_SELECT&nbsp;&nbsp;&nbsp;0x06          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00093">93</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="3e7061dc18462050457e33662f885f63"></a><!-- doxytag: member="usb_dfu.c::CMD_GRP_UPLOAD" ref="3e7061dc18462050457e33662f885f63" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_GRP_UPLOAD&nbsp;&nbsp;&nbsp;0x03          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00091">91</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>, and <a class="el" href="a00055.html#l00721">usb_dfu_upload()</a>.
</div>
</div><p>
<a class="anchor" name="98292ffceeb8fd22e929fe412223a6a4"></a><!-- doxytag: member="usb_dfu.c::CMD_PROGRAM_START" ref="98292ffceeb8fd22e929fe412223a6a4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_PROGRAM_START&nbsp;&nbsp;&nbsp;0x00          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00096">96</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="929b607d33ea7317ece0130f4bd7dea9"></a><!-- doxytag: member="usb_dfu.c::CMD_READ_MEMORY" ref="929b607d33ea7317ece0130f4bd7dea9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_READ_MEMORY&nbsp;&nbsp;&nbsp;0x00          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00099">99</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>, and <a class="el" href="a00055.html#l00721">usb_dfu_upload()</a>.
</div>
</div><p>
<a class="anchor" name="91718c9f4c48630faceac10d005cbce6"></a><!-- doxytag: member="usb_dfu.c::CMD_SELECT_MEMORY" ref="91718c9f4c48630faceac10d005cbce6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_SELECT_MEMORY&nbsp;&nbsp;&nbsp;0x03          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00107">107</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="786167bf73a3c317633a5a89a734b13e"></a><!-- doxytag: member="usb_dfu.c::CMD_SELECT_MEMORY_ARG_PAGE" ref="786167bf73a3c317633a5a89a734b13e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_SELECT_MEMORY_ARG_PAGE&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00118">118</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="e2c20d9b274a70e96b297cbdc901fa02"></a><!-- doxytag: member="usb_dfu.c::CMD_SELECT_MEMORY_ARG_UNIT" ref="e2c20d9b274a70e96b297cbdc901fa02" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_SELECT_MEMORY_ARG_UNIT&nbsp;&nbsp;&nbsp;0x00          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00117">117</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="9718c80eab4acb4586586415eb040a13"></a><!-- doxytag: member="usb_dfu.c::CMD_START_APPLI" ref="9718c80eab4acb4586586415eb040a13" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_START_APPLI&nbsp;&nbsp;&nbsp;0x03          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00104">104</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="fd8d379083e82679309bbf8e7248a581"></a><!-- doxytag: member="usb_dfu.c::CMD_START_APPLI_ARG_NO_RESET" ref="fd8d379083e82679309bbf8e7248a581" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_START_APPLI_ARG_NO_RESET&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00114">114</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="0da96ca4396e799943d1a84adb3980ea"></a><!-- doxytag: member="usb_dfu.c::CMD_START_APPLI_ARG_RESET" ref="0da96ca4396e799943d1a84adb3980ea" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CMD_START_APPLI_ARG_RESET&nbsp;&nbsp;&nbsp;0x00          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00113">113</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="24f4dca5bd54b71cf42ade71d6fda1a2"></a><!-- doxytag: member="usb_dfu.c::dfu_format_dfu_to_mcu_data" ref="24f4dca5bd54b71cf42ade71d6fda1a2" args="(width, data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define dfu_format_dfu_to_mcu_data          </td>
          <td>(</td>
          <td class="paramtype">width,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;((TPASTE2(U, width))(data))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00084">84</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00314">get_and_check_mem_range()</a>.
</div>
</div><p>
<a class="anchor" name="0630af06c966e3a0cca52d416ed09df0"></a><!-- doxytag: member="usb_dfu.c::Dfu_format_dfu_to_mcu_data" ref="0630af06c966e3a0cca52d416ed09df0" args="(width, data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define Dfu_format_dfu_to_mcu_data          </td>
          <td>(</td>
          <td class="paramtype">width,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;((TPASTE2(U, width))(data))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00082">82</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
</div>
</div><p>
<a class="anchor" name="7a1cd9007045ae21acde0b48f7bdd9af"></a><!-- doxytag: member="usb_dfu.c::dfu_format_mcu_to_dfu_data" ref="7a1cd9007045ae21acde0b48f7bdd9af" args="(width, data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define dfu_format_mcu_to_dfu_data          </td>
          <td>(</td>
          <td class="paramtype">width,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;((TPASTE2(U, width))(data))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00083">83</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00721">usb_dfu_upload()</a>.
</div>
</div><p>
<a class="anchor" name="b4fccfecd518189c1a46925fdf1a0dbc"></a><!-- doxytag: member="usb_dfu.c::Dfu_format_mcu_to_dfu_data" ref="b4fccfecd518189c1a46925fdf1a0dbc" args="(width, data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define Dfu_format_mcu_to_dfu_data          </td>
          <td>(</td>
          <td class="paramtype">width,         <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%">&nbsp;&nbsp;&nbsp;((TPASTE2(U, width))(data))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Convert 16-, 32- or 64-bit data between MCU and Atmel-DFU endianisms. 
<p>
Depending on MCU endianism, swap or not data bytes. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>width</em>&nbsp;</td><td>Data width in bits: 16, 32 or 64 </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>16-, 32- or 64-bit data to format </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Formatted 16-, 32- or 64-bit data </dd></dl>

<p>
Definition at line <a class="el" href="a00055.html#l00081">81</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
</div>
</div><p>
<a class="anchor" name="56020df3bb796fc06d6ed56185b56cff"></a><!-- doxytag: member="usb_dfu.c::ISP_ID0_ADDRESS" ref="56020df3bb796fc06d6ed56185b56cff" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ISP_ID0_ADDRESS&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00143">143</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
</div>
</div><p>
<a class="anchor" name="3749e16d048acfa0fbb70090416a5023"></a><!-- doxytag: member="usb_dfu.c::ISP_ID1_ADDRESS" ref="3749e16d048acfa0fbb70090416a5023" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ISP_ID1_ADDRESS&nbsp;&nbsp;&nbsp;0x02          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00144">144</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
</div>
</div><p>
<a class="anchor" name="34a53d91f166e0a028cdbde481a7bc99"></a><!-- doxytag: member="usb_dfu.c::ISP_INF_ITEM_COUNT" ref="34a53d91f166e0a028cdbde481a7bc99" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ISP_INF_ITEM_COUNT&nbsp;&nbsp;&nbsp;(ISP_ID1_ADDRESS + 1)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00147">147</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
</div>
</div><p>
<a class="anchor" name="3a987c8b4b927f14dd17a51e048b296c"></a><!-- doxytag: member="usb_dfu.c::ISP_VERSION_ADDRESS" ref="3a987c8b4b927f14dd17a51e048b296c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ISP_VERSION_ADDRESS&nbsp;&nbsp;&nbsp;0x00          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00142">142</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
</div>
</div><p>
<a class="anchor" name="7312bc7c0f3695bff0b7fbc15dbb37f8"></a><!-- doxytag: member="usb_dfu.c::MEM_BOOTLOADER" ref="7312bc7c0f3695bff0b7fbc15dbb37f8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MEM_BOOTLOADER&nbsp;&nbsp;&nbsp;0x04          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00125">125</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="4d3c302c0479b8044fefd249ddd501d0"></a><!-- doxytag: member="usb_dfu.c::MEM_CONFIGURATION" ref="4d3c302c0479b8044fefd249ddd501d0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MEM_CONFIGURATION&nbsp;&nbsp;&nbsp;0x03          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00124">124</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="f9aa07058fa68e55a307388ac38395cc"></a><!-- doxytag: member="usb_dfu.c::MEM_COUNT" ref="f9aa07058fa68e55a307388ac38395cc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MEM_COUNT&nbsp;&nbsp;&nbsp;(MEM_USER + 1)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00130">130</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
</div>
</div><p>
<a class="anchor" name="a9997d933806a6fb207fb55930432a00"></a><!-- doxytag: member="usb_dfu.c::MEM_EEPROM" ref="a9997d933806a6fb207fb55930432a00" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MEM_EEPROM&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00122">122</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="797e277b6bad54cbefc14fe6a4ef0605"></a><!-- doxytag: member="usb_dfu.c::MEM_FLASH" ref="797e277b6bad54cbefc14fe6a4ef0605" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MEM_FLASH&nbsp;&nbsp;&nbsp;0x00          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00121">121</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>, and <a class="el" href="a00055.html#l00493">usb_dfu_init()</a>.
</div>
</div><p>
<a class="anchor" name="f82d999ce5fc205a187090bfbefef388"></a><!-- doxytag: member="usb_dfu.c::MEM_SECURITY" ref="f82d999ce5fc205a187090bfbefef388" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MEM_SECURITY&nbsp;&nbsp;&nbsp;0x02          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00123">123</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="81160b040a07265ec9ea9ade3480c135"></a><!-- doxytag: member="usb_dfu.c::MEM_SIGNATURE" ref="81160b040a07265ec9ea9ade3480c135" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MEM_SIGNATURE&nbsp;&nbsp;&nbsp;0x05          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00126">126</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="1168f49bb6b4954943fba4baa4a6ea8f"></a><!-- doxytag: member="usb_dfu.c::MEM_USER" ref="1168f49bb6b4954943fba4baa4a6ea8f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MEM_USER&nbsp;&nbsp;&nbsp;0x06          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00127">127</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="42a78d1bbe8651f134eea6e179737a41"></a><!-- doxytag: member="usb_dfu.c::PRODUCT_FAMILY_ID_ADDRESS" ref="42a78d1bbe8651f134eea6e179737a41" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRODUCT_FAMILY_ID_ADDRESS&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00134">134</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
</div>
</div><p>
<a class="anchor" name="e38961fa867d62efaf9fd7b35a6c9831"></a><!-- doxytag: member="usb_dfu.c::PRODUCT_ID_ADDRESS" ref="e38961fa867d62efaf9fd7b35a6c9831" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRODUCT_ID_ADDRESS&nbsp;&nbsp;&nbsp;0x02          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00135">135</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00493">usb_dfu_init()</a>.
</div>
</div><p>
<a class="anchor" name="88290f7ab3a58886effc1e79bd672b95"></a><!-- doxytag: member="usb_dfu.c::PRODUCT_INF_ITEM_COUNT" ref="88290f7ab3a58886effc1e79bd672b95" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRODUCT_INF_ITEM_COUNT&nbsp;&nbsp;&nbsp;(PRODUCT_REVISION_ADDRESS + 1)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00139">139</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
</div>
</div><p>
<a class="anchor" name="16808bee8d0f6af23eeb063a1f4bc6d7"></a><!-- doxytag: member="usb_dfu.c::PRODUCT_MANUFACTURER_ID_ADDRESS" ref="16808bee8d0f6af23eeb063a1f4bc6d7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRODUCT_MANUFACTURER_ID_ADDRESS&nbsp;&nbsp;&nbsp;0x00          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00133">133</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
</div>
</div><p>
<a class="anchor" name="6bcaecfc51c7d24e73cfecb15dbfbeaa"></a><!-- doxytag: member="usb_dfu.c::PRODUCT_REVISION_ADDRESS" ref="6bcaecfc51c7d24e73cfecb15dbfbeaa" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PRODUCT_REVISION_ADDRESS&nbsp;&nbsp;&nbsp;0x03          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00136">136</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00493">usb_dfu_init()</a>.
</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="d2e5148ff309825eba2285d628fd92b7"></a><!-- doxytag: member="usb_dfu.c::erase_check_mem" ref="d2e5148ff309825eba2285d628fd92b7" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void erase_check_mem           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00402">402</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
References <a class="el" href="a00043.html#l00113">DFU_FRAME_LENGTH</a>, <a class="el" href="a00055.html#l00168">address_t::long_address</a>, <a class="el" href="a00030.html#25bcfc8e0357e922449012b0d41e30c7">MEMORY_ACCESS</a>, <a class="el" href="a00055.html#l00292">start_address</a>, and <a class="el" href="a00056.html#l00069">STATUS_errCHECK_ERASED</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.<div class="fragment"><pre class="fragment"><a name="l00403"></a>00403 {
<a name="l00404"></a>00404   U8 *frame;
<a name="l00405"></a>00405   U32 frame_bytes;
<a name="l00406"></a>00406 
<a name="l00407"></a>00407   <span class="keywordflow">while</span> (<a class="code" href="a00030.html#0aa37fb76bd78e4b768975044d4e5eac">data_bytes</a>)
<a name="l00408"></a>00408   {
<a name="l00409"></a>00409     frame = <a class="code" href="a00030.html#80a3547e13a5115ed61c1e6001bddb35">dfu_frame</a>;
<a name="l00410"></a>00410     frame_bytes = min(<a class="code" href="a00030.html#0aa37fb76bd78e4b768975044d4e5eac">data_bytes</a>, <a class="code" href="a00018.html#3c4a332b7664e9c52426f821437df86e">DFU_FRAME_LENGTH</a>);
<a name="l00411"></a>00411     <a class="code" href="a00030.html#0aa37fb76bd78e4b768975044d4e5eac">data_bytes</a> -= frame_bytes;
<a name="l00412"></a>00412 
<a name="l00413"></a>00413     <a class="code" href="a00030.html#25bcfc8e0357e922449012b0d41e30c7">MEMORY_ACCESS</a>[<a class="code" href="a00030.html#374fbbe1cfcd927515a99f5cdfc3dee7">memory</a>].read(frame, <a class="code" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a>.<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a>, frame_bytes);
<a name="l00414"></a>00414 
<a name="l00415"></a>00415     <span class="keywordflow">while</span> (frame_bytes--)
<a name="l00416"></a>00416     {
<a name="l00417"></a>00417       <span class="keywordflow">if</span> (*frame++ != <a class="code" href="a00030.html#28dba1152c71ba300f1583f994d66682">MEMORY_ERASE_VALUE</a>[<a class="code" href="a00030.html#374fbbe1cfcd927515a99f5cdfc3dee7">memory</a>])
<a name="l00418"></a>00418       {
<a name="l00419"></a>00419         <a class="code" href="a00030.html#72b5d479cbc5c21ca31a3b96d758385f">dfu_status</a> = <a class="code" href="a00031.html#bef4e4e1a2737dec9c0e1412b66b7636">STATUS_errCHECK_ERASED</a>;
<a name="l00420"></a>00420         <span class="keywordflow">return</span>;
<a name="l00421"></a>00421       }
<a name="l00422"></a>00422       <a class="code" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a>.<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a>++;
<a name="l00423"></a>00423     }
<a name="l00424"></a>00424   }
<a name="l00425"></a>00425 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5d28db34d36ff3888f49976e45f9ebd1"></a><!-- doxytag: member="usb_dfu.c::force_isp" ref="5d28db34d36ff3888f49976e45f9ebd1" args="(Bool force)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void force_isp           </td>
          <td>(</td>
          <td class="paramtype">Bool&nbsp;</td>
          <td class="paramname"> <em>force</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00308">308</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
References <a class="el" href="a00045.html#l00511">flashc_set_gp_fuse_bit()</a>, and <a class="el" href="a00043.html#l00063">ISP_GPFB_FORCE_OFFSET</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>, and <a class="el" href="a00055.html#l00506">usb_dfu_stop()</a>.<div class="fragment"><pre class="fragment"><a name="l00309"></a>00309 {
<a name="l00310"></a>00310   <a class="code" href="a00020.html#5c5442a988c608baea0d1c0b841badca">flashc_set_gp_fuse_bit</a>(<a class="code" href="a00018.html#1a776132c37c6f0431182150d6566ae6">ISP_GPFB_FORCE_OFFSET</a>, force);
<a name="l00311"></a>00311 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="10c0d82cffcef9ae75dc19306f167309"></a><!-- doxytag: member="usb_dfu.c::get_and_check_mem_range" ref="10c0d82cffcef9ae75dc19306f167309" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static Bool get_and_check_mem_range           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00314">314</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
References <a class="el" href="a00055.html#l00084">dfu_format_dfu_to_mcu_data</a>, <a class="el" href="a00055.html#l00293">end_address</a>, <a class="el" href="a00055.html#l00168">address_t::long_address</a>, <a class="el" href="a00055.html#l00190">MEMORY_END_ADDRESS</a>, <a class="el" href="a00055.html#l00172">address_t::page_offset</a>, <a class="el" href="a00055.html#l00292">start_address</a>, and <a class="el" href="a00056.html#l00072">STATUS_errADDRESS</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.<div class="fragment"><pre class="fragment"><a name="l00315"></a>00315 {
<a name="l00316"></a>00316   <a class="code" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a>.<a class="code" href="a00001.html#7db971aec662548d8c5f3620b0ee7549">page_offset</a> = Usb_read_endpoint_data(EP_CONTROL, 16);
<a name="l00317"></a>00317   <a class="code" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a>.<a class="code" href="a00001.html#7db971aec662548d8c5f3620b0ee7549">page_offset</a> = <a class="code" href="a00030.html#24f4dca5bd54b71cf42ade71d6fda1a2">dfu_format_dfu_to_mcu_data</a>(16, <a class="code" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a>.<a class="code" href="a00001.html#7db971aec662548d8c5f3620b0ee7549">page_offset</a>);
<a name="l00318"></a>00318   <a class="code" href="a00030.html#52058289997b205a29f0908602c345ec">end_address</a>.<a class="code" href="a00001.html#7db971aec662548d8c5f3620b0ee7549">page_offset</a> = Usb_read_endpoint_data(EP_CONTROL, 16);
<a name="l00319"></a>00319   <a class="code" href="a00030.html#52058289997b205a29f0908602c345ec">end_address</a>.<a class="code" href="a00001.html#7db971aec662548d8c5f3620b0ee7549">page_offset</a> = <a class="code" href="a00030.html#24f4dca5bd54b71cf42ade71d6fda1a2">dfu_format_dfu_to_mcu_data</a>(16, <a class="code" href="a00030.html#52058289997b205a29f0908602c345ec">end_address</a>.<a class="code" href="a00001.html#7db971aec662548d8c5f3620b0ee7549">page_offset</a>);
<a name="l00320"></a>00320 
<a name="l00321"></a>00321   <span class="keywordflow">if</span> (<a class="code" href="a00030.html#52058289997b205a29f0908602c345ec">end_address</a>.<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a> &lt; <a class="code" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a>.<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a> ||
<a name="l00322"></a>00322       <a class="code" href="a00030.html#52058289997b205a29f0908602c345ec">end_address</a>.<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a> &gt; <a class="code" href="a00030.html#fa623b1048e8537f6aa02080171aea63">MEMORY_END_ADDRESS</a>[<a class="code" href="a00030.html#374fbbe1cfcd927515a99f5cdfc3dee7">memory</a>].<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a>)
<a name="l00323"></a>00323   {
<a name="l00324"></a>00324     <a class="code" href="a00030.html#72b5d479cbc5c21ca31a3b96d758385f">dfu_status</a> = <a class="code" href="a00031.html#e32f24e7d30d446dd9f487f4d5e55742">STATUS_errADDRESS</a>;
<a name="l00325"></a>00325     <span class="keywordflow">return</span> FALSE;
<a name="l00326"></a>00326   }
<a name="l00327"></a>00327 
<a name="l00328"></a>00328   <a class="code" href="a00030.html#0aa37fb76bd78e4b768975044d4e5eac">data_bytes</a> = <a class="code" href="a00030.html#52058289997b205a29f0908602c345ec">end_address</a>.<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a> - <a class="code" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a>.<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a> + 1;
<a name="l00329"></a>00329   <span class="keywordflow">return</span> TRUE;
<a name="l00330"></a>00330 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="bcae11a444dc30fdffd0e82a22af2fc7"></a><!-- doxytag: member="usb_dfu.c::is_isp_forced" ref="bcae11a444dc30fdffd0e82a22af2fc7" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static Bool is_isp_forced           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00302">302</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
References <a class="el" href="a00045.html#l00395">flashc_read_gp_fuse_bit()</a>, and <a class="el" href="a00043.html#l00063">ISP_GPFB_FORCE_OFFSET</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.<div class="fragment"><pre class="fragment"><a name="l00303"></a>00303 {
<a name="l00304"></a>00304   <span class="keywordflow">return</span> <a class="code" href="a00020.html#e6203d2e69ff15d59366c28bf8e26a7e">flashc_read_gp_fuse_bit</a>(<a class="code" href="a00018.html#1a776132c37c6f0431182150d6566ae6">ISP_GPFB_FORCE_OFFSET</a>);
<a name="l00305"></a>00305 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="d3479543c39793699024e1757f5e24c6"></a><!-- doxytag: member="usb_dfu.c::mem_bootloader_read" ref="d3479543c39793699024e1757f5e24c6" args="(void *dst, U32 src, size_t nbytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void mem_bootloader_read           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U32&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>nbytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00378">378</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
References <a class="el" href="a00055.html#l00183">ISP_INF</a>.<div class="fragment"><pre class="fragment"><a name="l00379"></a>00379 {
<a name="l00380"></a>00380   memcpy(dst, <a class="code" href="a00030.html#3313a5dc7ce36317cfeb9d5231b22a5e">ISP_INF</a> + src, nbytes);
<a name="l00381"></a>00381 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="0499a12792a9df3141d901a8993b9d5e"></a><!-- doxytag: member="usb_dfu.c::mem_configuration_read" ref="0499a12792a9df3141d901a8993b9d5e" args="(void *dst, U32 src, size_t nbytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void mem_configuration_read           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U32&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>nbytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00362">362</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
References <a class="el" href="a00045.html#l00395">flashc_read_gp_fuse_bit()</a>.<div class="fragment"><pre class="fragment"><a name="l00363"></a>00363 {
<a name="l00364"></a>00364   U8 *dest = dst;
<a name="l00365"></a>00365   <span class="keywordflow">while</span> (nbytes--)
<a name="l00366"></a>00366     *dest++ = <a class="code" href="a00020.html#e6203d2e69ff15d59366c28bf8e26a7e">flashc_read_gp_fuse_bit</a>(src++);
<a name="l00367"></a>00367 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="dd1519ac9a460afbbdf2f440618c3d94"></a><!-- doxytag: member="usb_dfu.c::mem_configuration_write" ref="dd1519ac9a460afbbdf2f440618c3d94" args="(U32 dst, const void *src, size_t nbytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void mem_configuration_write           </td>
          <td>(</td>
          <td class="paramtype">U32&nbsp;</td>
          <td class="paramname"> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>nbytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00370">370</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
References <a class="el" href="a00045.html#l00511">flashc_set_gp_fuse_bit()</a>.<div class="fragment"><pre class="fragment"><a name="l00371"></a>00371 {
<a name="l00372"></a>00372   <span class="keyword">const</span> U8 *source = src;
<a name="l00373"></a>00373   <span class="keywordflow">while</span> (nbytes--)
<a name="l00374"></a>00374     <a class="code" href="a00020.html#5c5442a988c608baea0d1c0b841badca">flashc_set_gp_fuse_bit</a>(dst++, *source++);
<a name="l00375"></a>00375 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="c481cf3f3240ebcf8ad2ebd2f25ea6a9"></a><!-- doxytag: member="usb_dfu.c::mem_flash_read" ref="c481cf3f3240ebcf8ad2ebd2f25ea6a9" args="(void *dst, U32 src, size_t nbytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void mem_flash_read           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U32&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>nbytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00333">333</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.<div class="fragment"><pre class="fragment"><a name="l00334"></a>00334 {
<a name="l00335"></a>00335   memcpy(dst, AVR32_FLASH + src, nbytes);
<a name="l00336"></a>00336 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="a5e72de95c2eaebc50e90097f7a517aa"></a><!-- doxytag: member="usb_dfu.c::mem_flash_write" ref="a5e72de95c2eaebc50e90097f7a517aa" args="(U32 dst, const void *src, size_t nbytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void mem_flash_write           </td>
          <td>(</td>
          <td class="paramtype">U32&nbsp;</td>
          <td class="paramname"> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>nbytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00339">339</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
References <a class="el" href="a00045.html#l00870">flashc_memcpy()</a>.<div class="fragment"><pre class="fragment"><a name="l00340"></a>00340 {
<a name="l00341"></a>00341   <a class="code" href="a00020.html#b257e261b58cabbd30f176287882886e">flashc_memcpy</a>(AVR32_FLASH + dst, src, nbytes, FALSE);
<a name="l00342"></a>00342 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="4c792a0bd2076acf4634e57681c1bb0c"></a><!-- doxytag: member="usb_dfu.c::mem_security_read" ref="4c792a0bd2076acf4634e57681c1bb0c" args="(void *dst, U32 src, size_t nbytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void mem_security_read           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U32&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>nbytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00345">345</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
References <a class="el" href="a00045.html#l00301">flashc_is_security_bit_active()</a>.<div class="fragment"><pre class="fragment"><a name="l00346"></a>00346 {
<a name="l00347"></a>00347   <span class="keywordflow">if</span> (nbytes)
<a name="l00348"></a>00348     *(U8 *)dst = <a class="code" href="a00020.html#03df73f0be08f7bc503f3c336b1abdc1">flashc_is_security_bit_active</a>();
<a name="l00349"></a>00349 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="74a43f1070ea11f921ad79c6630bb4b8"></a><!-- doxytag: member="usb_dfu.c::mem_security_write" ref="74a43f1070ea11f921ad79c6630bb4b8" args="(U32 dst, const void *src, size_t nbytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void mem_security_write           </td>
          <td>(</td>
          <td class="paramtype">U32&nbsp;</td>
          <td class="paramname"> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>nbytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00352">352</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
References <a class="el" href="a00045.html#l00307">flashc_activate_security_bit()</a>.<div class="fragment"><pre class="fragment"><a name="l00353"></a>00353 {
<a name="l00354"></a>00354   <span class="keywordflow">if</span> (nbytes &amp;&amp; *(U8 *)src)
<a name="l00355"></a>00355   {
<a name="l00356"></a>00356     <a class="code" href="a00030.html#2361500f6c05783fa72cb2054c93e3f0">security_active</a> = TRUE;
<a name="l00357"></a>00357     <a class="code" href="a00020.html#245cc33e09bc45b78d4fdc189ba6fd85">flashc_activate_security_bit</a>();
<a name="l00358"></a>00358   }
<a name="l00359"></a>00359 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="2e54669ffd957a372461d6f276335a54"></a><!-- doxytag: member="usb_dfu.c::mem_signature_read" ref="2e54669ffd957a372461d6f276335a54" args="(void *dst, U32 src, size_t nbytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void mem_signature_read           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U32&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>nbytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00384">384</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
References <a class="el" href="a00055.html#l00177">PRODUCT_INF</a>.<div class="fragment"><pre class="fragment"><a name="l00385"></a>00385 {
<a name="l00386"></a>00386   memcpy(dst, <a class="code" href="a00030.html#52ebe39948f0519a749b834767124cad">PRODUCT_INF</a> + src, nbytes);
<a name="l00387"></a>00387 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="63a7ddfd58667d72f478b3b05f1297a4"></a><!-- doxytag: member="usb_dfu.c::mem_user_read" ref="63a7ddfd58667d72f478b3b05f1297a4" args="(void *dst, U32 src, size_t nbytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void mem_user_read           </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">U32&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>nbytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00390">390</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.<div class="fragment"><pre class="fragment"><a name="l00391"></a>00391 {
<a name="l00392"></a>00392   memcpy(dst, (U8 *)AVR32_FLASHC_USER_PAGE + src, nbytes);
<a name="l00393"></a>00393 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="21199eac84376d68001dd00cecf691b2"></a><!-- doxytag: member="usb_dfu.c::mem_user_write" ref="21199eac84376d68001dd00cecf691b2" args="(U32 dst, const void *src, size_t nbytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void mem_user_write           </td>
          <td>(</td>
          <td class="paramtype">U32&nbsp;</td>
          <td class="paramname"> <em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>nbytes</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00396">396</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
References <a class="el" href="a00045.html#l00870">flashc_memcpy()</a>.<div class="fragment"><pre class="fragment"><a name="l00397"></a>00397 {
<a name="l00398"></a>00398   <a class="code" href="a00020.html#b257e261b58cabbd30f176287882886e">flashc_memcpy</a>(AVR32_FLASHC_USER_PAGE + dst, src, nbytes, TRUE);
<a name="l00399"></a>00399 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="c47b9a242f66117db14205a3d75b6c0c"></a><!-- doxytag: member="usb_dfu.c::read_mem" ref="c47b9a242f66117db14205a3d75b6c0c" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void read_mem           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00428">428</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
References <a class="el" href="a00043.html#l00113">DFU_FRAME_LENGTH</a>, <a class="el" href="a00055.html#l00168">address_t::long_address</a>, <a class="el" href="a00030.html#25bcfc8e0357e922449012b0d41e30c7">MEMORY_ACCESS</a>, and <a class="el" href="a00055.html#l00292">start_address</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00721">usb_dfu_upload()</a>.<div class="fragment"><pre class="fragment"><a name="l00429"></a>00429 {
<a name="l00430"></a>00430   <span class="keywordtype">void</span> *frame;
<a name="l00431"></a>00431   U32 frame_bytes;
<a name="l00432"></a>00432 
<a name="l00433"></a>00433   <span class="keywordflow">while</span> (<a class="code" href="a00030.html#0aa37fb76bd78e4b768975044d4e5eac">data_bytes</a>)
<a name="l00434"></a>00434   {
<a name="l00435"></a>00435     frame = <a class="code" href="a00030.html#80a3547e13a5115ed61c1e6001bddb35">dfu_frame</a>;
<a name="l00436"></a>00436     frame_bytes = min(<a class="code" href="a00030.html#0aa37fb76bd78e4b768975044d4e5eac">data_bytes</a>, <a class="code" href="a00018.html#3c4a332b7664e9c52426f821437df86e">DFU_FRAME_LENGTH</a>);
<a name="l00437"></a>00437     <a class="code" href="a00030.html#0aa37fb76bd78e4b768975044d4e5eac">data_bytes</a> -= frame_bytes;
<a name="l00438"></a>00438 
<a name="l00439"></a>00439     <a class="code" href="a00030.html#25bcfc8e0357e922449012b0d41e30c7">MEMORY_ACCESS</a>[<a class="code" href="a00030.html#374fbbe1cfcd927515a99f5cdfc3dee7">memory</a>].read(frame, <a class="code" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a>.<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a>, frame_bytes);
<a name="l00440"></a>00440     <a class="code" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a>.<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a> += frame_bytes;
<a name="l00441"></a>00441 
<a name="l00442"></a>00442     <span class="keywordflow">while</span> (frame_bytes)
<a name="l00443"></a>00443     {
<a name="l00444"></a>00444       <span class="keywordflow">while</span> (!Is_usb_control_in_ready());
<a name="l00445"></a>00445 
<a name="l00446"></a>00446       Usb_reset_endpoint_fifo_access(EP_CONTROL);
<a name="l00447"></a>00447       frame_bytes = usb_write_ep_txpacket(EP_CONTROL, frame, frame_bytes, (<span class="keyword">const</span> <span class="keywordtype">void</span> **)&amp;frame);
<a name="l00448"></a>00448       Usb_ack_control_in_ready_send();
<a name="l00449"></a>00449     }
<a name="l00450"></a>00450   }
<a name="l00451"></a>00451 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="15eaa33f32d6fde4ea8ba7e408b9492a"></a><!-- doxytag: member="usb_dfu.c::usb_dfu_dnload" ref="15eaa33f32d6fde4ea8ba7e408b9492a" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Bool usb_dfu_dnload           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Management of the DFU_DNLOAD requests. 
<p>

<p>
Definition at line <a class="el" href="a00055.html#l00529">529</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
References <a class="el" href="a00016.html#628154782d795e03dc8a807545dd0622">boot_program()</a>, <a class="el" href="a00055.html#l00100">CMD_BLANK_CHECK</a>, <a class="el" href="a00055.html#l00103">CMD_ERASE</a>, <a class="el" href="a00055.html#l00110">CMD_ERASE_ARG_CHIP</a>, <a class="el" href="a00055.html#l00090">CMD_GRP_DNLOAD</a>, <a class="el" href="a00055.html#l00092">CMD_GRP_EXEC</a>, <a class="el" href="a00055.html#l00093">CMD_GRP_SELECT</a>, <a class="el" href="a00055.html#l00091">CMD_GRP_UPLOAD</a>, <a class="el" href="a00055.html#l00096">CMD_PROGRAM_START</a>, <a class="el" href="a00055.html#l00099">CMD_READ_MEMORY</a>, <a class="el" href="a00055.html#l00107">CMD_SELECT_MEMORY</a>, <a class="el" href="a00055.html#l00118">CMD_SELECT_MEMORY_ARG_PAGE</a>, <a class="el" href="a00055.html#l00117">CMD_SELECT_MEMORY_ARG_UNIT</a>, <a class="el" href="a00055.html#l00104">CMD_START_APPLI</a>, <a class="el" href="a00055.html#l00114">CMD_START_APPLI_ARG_NO_RESET</a>, <a class="el" href="a00055.html#l00113">CMD_START_APPLI_ARG_RESET</a>, <a class="el" href="a00055.html#l00293">end_address</a>, <a class="el" href="a00055.html#l00402">erase_check_mem()</a>, <a class="el" href="a00045.html#l00616">flashc_erase_all_pages()</a>, <a class="el" href="a00045.html#l00374">flashc_lock_all_regions()</a>, <a class="el" href="a00055.html#l00308">force_isp()</a>, <a class="el" href="a00055.html#l00314">get_and_check_mem_range()</a>, <a class="el" href="a00055.html#l00302">is_isp_forced()</a>, <a class="el" href="a00055.html#l00168">address_t::long_address</a>, <a class="el" href="a00055.html#l00125">MEM_BOOTLOADER</a>, <a class="el" href="a00055.html#l00124">MEM_CONFIGURATION</a>, <a class="el" href="a00055.html#l00122">MEM_EEPROM</a>, <a class="el" href="a00055.html#l00121">MEM_FLASH</a>, <a class="el" href="a00055.html#l00123">MEM_SECURITY</a>, <a class="el" href="a00055.html#l00126">MEM_SIGNATURE</a>, <a class="el" href="a00055.html#l00127">MEM_USER</a>, <a class="el" href="a00030.html#25bcfc8e0357e922449012b0d41e30c7">MEMORY_ACCESS</a>, <a class="el" href="a00055.html#l00190">MEMORY_END_ADDRESS</a>, <a class="el" href="a00055.html#l00171">address_t::page</a>, <a class="el" href="a00030.html#2ee0f257169fa94a36a103b84afa7101">read</a>, <a class="el" href="a00055.html#l00292">start_address</a>, <a class="el" href="a00056.html#l00072">STATUS_errADDRESS</a>, <a class="el" href="a00056.html#l00069">STATUS_errCHECK_ERASED</a>, <a class="el" href="a00056.html#l00079">STATUS_errSTALLEDPKT</a>, <a class="el" href="a00056.html#l00071">STATUS_errVERIFY</a>, <a class="el" href="a00056.html#l00067">STATUS_errWRITE</a>, <a class="el" href="a00056.html#l00064">STATUS_OK</a>, <a class="el" href="a00049.html#l00174">sys_clk_gen_stop()</a>, <a class="el" href="a00055.html#l00506">usb_dfu_stop()</a>, <a class="el" href="a00049.html#l00066">wait_10_ms()</a>, <a class="el" href="a00030.html#76c4ac28168870c768186fd58667751c">write</a>, and <a class="el" href="a00055.html#l00454">write_mem()</a>.
<p>
Referenced by <a class="el" href="a00057.html#l00087">usb_user_read_request()</a>.<div class="fragment"><pre class="fragment"><a name="l00530"></a>00530 {
<a name="l00531"></a>00531   <span class="keyword">static</span> U8 tmp_memory;
<a name="l00532"></a>00532   <span class="keyword">static</span> U16 tmp_page;
<a name="l00533"></a>00533 
<a name="l00534"></a>00534   <span class="keywordflow">if</span> (!<a class="code" href="a00030.html#bcae11a444dc30fdffd0e82a22af2fc7">is_isp_forced</a>()) <a class="code" href="a00030.html#5d28db34d36ff3888f49976e45f9ebd1">force_isp</a>(TRUE);
<a name="l00535"></a>00535 
<a name="l00536"></a>00536   <a class="code" href="a00030.html#72b5d479cbc5c21ca31a3b96d758385f">dfu_status</a> = <a class="code" href="a00031.html#2403320c41f08e7567cb169de5db66b3">STATUS_OK</a>;
<a name="l00537"></a>00537 
<a name="l00538"></a>00538   Usb_read_endpoint_data(EP_CONTROL, 16); <span class="comment">// Dummy read: wValue.</span>
<a name="l00539"></a>00539   Usb_read_endpoint_data(EP_CONTROL, 16); <span class="comment">// Dummy read: wIndex.</span>
<a name="l00540"></a>00540   <a class="code" href="a00030.html#2f00e80c587129859a23d409c849cb9d">length</a> = Usb_read_endpoint_data(EP_CONTROL, 16);
<a name="l00541"></a>00541   <a class="code" href="a00030.html#2f00e80c587129859a23d409c849cb9d">length</a> = usb_format_usb_to_mcu_data(16, <a class="code" href="a00030.html#2f00e80c587129859a23d409c849cb9d">length</a>);
<a name="l00542"></a>00542   Usb_ack_setup_received_free();
<a name="l00543"></a>00543 
<a name="l00544"></a>00544   <span class="keywordflow">if</span> (<a class="code" href="a00030.html#2f00e80c587129859a23d409c849cb9d">length</a>)
<a name="l00545"></a>00545   {
<a name="l00546"></a>00546     <span class="keywordflow">while</span> (!Is_usb_control_out_received());
<a name="l00547"></a>00547     Usb_reset_endpoint_fifo_access(EP_CONTROL);
<a name="l00548"></a>00548 
<a name="l00549"></a>00549     <a class="code" href="a00030.html#10507ab3bbf2da5fef97e2c2d55a1bef">cmd_group</a> = Usb_read_endpoint_data(EP_CONTROL, 8);
<a name="l00550"></a>00550     <a class="code" href="a00030.html#4f661e7cb6f9a5ded3ac456d0ab7d319">cmd</a> = Usb_read_endpoint_data(EP_CONTROL, 8);
<a name="l00551"></a>00551     <span class="keywordflow">switch</span> (<a class="code" href="a00030.html#10507ab3bbf2da5fef97e2c2d55a1bef">cmd_group</a>)
<a name="l00552"></a>00552     {
<a name="l00553"></a>00553     <span class="keywordflow">case</span> <a class="code" href="a00030.html#eb26fb98af27b1b6124e6d4b04441776">CMD_GRP_DNLOAD</a>:
<a name="l00554"></a>00554       <span class="keywordflow">if</span> (<a class="code" href="a00030.html#2361500f6c05783fa72cb2054c93e3f0">security_active</a>)
<a name="l00555"></a>00555       {
<a name="l00556"></a>00556         <span class="keywordflow">goto</span> unsupported_request;
<a name="l00557"></a>00557       }
<a name="l00558"></a>00558       <span class="keywordflow">if</span> (!<a class="code" href="a00030.html#10c0d82cffcef9ae75dc19306f167309">get_and_check_mem_range</a>()) <span class="keywordflow">break</span>;
<a name="l00559"></a>00559       <span class="keywordflow">if</span> (!<a class="code" href="a00030.html#25bcfc8e0357e922449012b0d41e30c7">MEMORY_ACCESS</a>[<a class="code" href="a00030.html#374fbbe1cfcd927515a99f5cdfc3dee7">memory</a>].<a class="code" href="a00030.html#76c4ac28168870c768186fd58667751c">write</a>)
<a name="l00560"></a>00560       {
<a name="l00561"></a>00561         <a class="code" href="a00030.html#72b5d479cbc5c21ca31a3b96d758385f">dfu_status</a> = <a class="code" href="a00031.html#fd69c5c712eb452dce7b77919198dfba">STATUS_errWRITE</a>;
<a name="l00562"></a>00562         <span class="keywordflow">break</span>;
<a name="l00563"></a>00563       }
<a name="l00564"></a>00564       <span class="keywordflow">switch</span> (<a class="code" href="a00030.html#4f661e7cb6f9a5ded3ac456d0ab7d319">cmd</a>)
<a name="l00565"></a>00565       {
<a name="l00566"></a>00566       <span class="keywordflow">case</span> <a class="code" href="a00030.html#98292ffceeb8fd22e929fe412223a6a4">CMD_PROGRAM_START</a>:
<a name="l00567"></a>00567         Usb_ack_control_out_received_free();
<a name="l00568"></a>00568         <a class="code" href="a00030.html#d32db56ce57a924629571ebbb28066f0">write_mem</a>();
<a name="l00569"></a>00569         <span class="keywordflow">break</span>;
<a name="l00570"></a>00570 
<a name="l00571"></a>00571       <span class="keywordflow">default</span>:
<a name="l00572"></a>00572         <span class="keywordflow">goto</span> unsupported_request;
<a name="l00573"></a>00573       }
<a name="l00574"></a>00574       <span class="keywordflow">break</span>;
<a name="l00575"></a>00575 
<a name="l00576"></a>00576     <span class="keywordflow">case</span> <a class="code" href="a00030.html#3e7061dc18462050457e33662f885f63">CMD_GRP_UPLOAD</a>:
<a name="l00577"></a>00577       <span class="keywordflow">if</span> (security_active)
<a name="l00578"></a>00578       {
<a name="l00579"></a>00579         <span class="keywordflow">goto</span> unsupported_request;
<a name="l00580"></a>00580       }
<a name="l00581"></a>00581       <span class="keywordflow">if</span> (!<a class="code" href="a00030.html#10c0d82cffcef9ae75dc19306f167309">get_and_check_mem_range</a>()) <span class="keywordflow">break</span>;
<a name="l00582"></a>00582       <span class="keywordflow">if</span> (!<a class="code" href="a00030.html#25bcfc8e0357e922449012b0d41e30c7">MEMORY_ACCESS</a>[<a class="code" href="a00030.html#374fbbe1cfcd927515a99f5cdfc3dee7">memory</a>].<a class="code" href="a00030.html#2ee0f257169fa94a36a103b84afa7101">read</a>)
<a name="l00583"></a>00583       {
<a name="l00584"></a>00584         <a class="code" href="a00030.html#72b5d479cbc5c21ca31a3b96d758385f">dfu_status</a> = <a class="code" href="a00031.html#0d02117b3b3ac0e37ea30c91a7f2a43a">STATUS_errVERIFY</a>;
<a name="l00585"></a>00585         <span class="keywordflow">break</span>;
<a name="l00586"></a>00586       }
<a name="l00587"></a>00587       <span class="keywordflow">switch</span> (<a class="code" href="a00030.html#4f661e7cb6f9a5ded3ac456d0ab7d319">cmd</a>)
<a name="l00588"></a>00588       {
<a name="l00589"></a>00589       <span class="keywordflow">case</span> <a class="code" href="a00030.html#929b607d33ea7317ece0130f4bd7dea9">CMD_READ_MEMORY</a>:
<a name="l00590"></a>00590         <span class="keywordflow">break</span>;
<a name="l00591"></a>00591 
<a name="l00592"></a>00592       <span class="keywordflow">case</span> <a class="code" href="a00030.html#de21f96609d5cf42318df9b16c4ced73">CMD_BLANK_CHECK</a>:
<a name="l00593"></a>00593         <a class="code" href="a00030.html#d2e5148ff309825eba2285d628fd92b7">erase_check_mem</a>();
<a name="l00594"></a>00594         <span class="keywordflow">break</span>;
<a name="l00595"></a>00595 
<a name="l00596"></a>00596       <span class="keywordflow">default</span>:
<a name="l00597"></a>00597         <span class="keywordflow">goto</span> unsupported_request;
<a name="l00598"></a>00598       }
<a name="l00599"></a>00599       <span class="keywordflow">break</span>;
<a name="l00600"></a>00600 
<a name="l00601"></a>00601     <span class="keywordflow">case</span> <a class="code" href="a00030.html#6440653aacc649380510aa31830f3ad5">CMD_GRP_EXEC</a>:
<a name="l00602"></a>00602       <span class="keywordflow">switch</span> (<a class="code" href="a00030.html#4f661e7cb6f9a5ded3ac456d0ab7d319">cmd</a>)
<a name="l00603"></a>00603       {
<a name="l00604"></a>00604       <span class="keywordflow">case</span> <a class="code" href="a00030.html#73d541696536a935eec42edc03359e96">CMD_ERASE</a>:
<a name="l00605"></a>00605         <span class="keywordflow">switch</span> (Usb_read_endpoint_data(EP_CONTROL, 8))
<a name="l00606"></a>00606         {
<a name="l00607"></a>00607         <span class="keywordflow">case</span> <a class="code" href="a00030.html#7cab61d2d864b9953bfe36de80bb6f01">CMD_ERASE_ARG_CHIP</a>:
<a name="l00608"></a>00608           <a class="code" href="a00030.html#374fbbe1cfcd927515a99f5cdfc3dee7">memory</a> = <a class="code" href="a00030.html#797e277b6bad54cbefc14fe6a4ef0605">MEM_FLASH</a>;
<a name="l00609"></a>00609           <a class="code" href="a00030.html#52058289997b205a29f0908602c345ec">end_address</a>.<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a> = <a class="code" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a>.<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a> = 0;
<a name="l00610"></a>00610           <a class="code" href="a00020.html#7c05cca97169ee6888828c40243c0191">flashc_lock_all_regions</a>(FALSE);
<a name="l00611"></a>00611           <a class="code" href="a00020.html#230f4c4dcf517606a540dfa1df3efa91">flashc_erase_all_pages</a>(FALSE);
<a name="l00612"></a>00612           security_active = FALSE;
<a name="l00613"></a>00613           <span class="keywordflow">break</span>;
<a name="l00614"></a>00614 
<a name="l00615"></a>00615         <span class="keywordflow">default</span>:
<a name="l00616"></a>00616           <span class="keywordflow">goto</span> unsupported_request;
<a name="l00617"></a>00617         }
<a name="l00618"></a>00618         <span class="keywordflow">break</span>;
<a name="l00619"></a>00619 
<a name="l00620"></a>00620       <span class="keywordflow">case</span> <a class="code" href="a00030.html#9718c80eab4acb4586586415eb040a13">CMD_START_APPLI</a>:
<a name="l00621"></a>00621         <span class="keywordflow">switch</span> (Usb_read_endpoint_data(EP_CONTROL, 8))
<a name="l00622"></a>00622         {
<a name="l00623"></a>00623         <span class="keywordflow">case</span> <a class="code" href="a00030.html#0da96ca4396e799943d1a84adb3980ea">CMD_START_APPLI_ARG_RESET</a>:
<a name="l00624"></a>00624           <a class="code" href="a00030.html#4ea17de3f3e93df51ea8f68aa9ca5f9f">usb_dfu_stop</a>();
<a name="l00625"></a>00625           Disable_global_interrupt();
<a name="l00626"></a>00626           AVR32_WDT.ctrl = AVR32_WDT_CTRL_EN_MASK |
<a name="l00627"></a>00627                            (10 &lt;&lt; AVR32_WDT_CTRL_PSEL_OFFSET) |
<a name="l00628"></a>00628                            (AVR32_WDT_KEY_VALUE &lt;&lt; AVR32_WDT_CTRL_KEY_OFFSET);
<a name="l00629"></a>00629           AVR32_WDT.ctrl = AVR32_WDT_CTRL_EN_MASK |
<a name="l00630"></a>00630                            (10 &lt;&lt; AVR32_WDT_CTRL_PSEL_OFFSET) |
<a name="l00631"></a>00631                            ((~AVR32_WDT_KEY_VALUE &lt;&lt; AVR32_WDT_CTRL_KEY_OFFSET) &amp; AVR32_WDT_CTRL_KEY_MASK);
<a name="l00632"></a>00632           <span class="keywordflow">while</span> (1);
<a name="l00633"></a>00633           <span class="keywordflow">break</span>;
<a name="l00634"></a>00634 
<a name="l00635"></a>00635         <span class="keywordflow">case</span> <a class="code" href="a00030.html#fd8d379083e82679309bbf8e7248a581">CMD_START_APPLI_ARG_NO_RESET</a>:
<a name="l00636"></a>00636           <a class="code" href="a00030.html#4ea17de3f3e93df51ea8f68aa9ca5f9f">usb_dfu_stop</a>();
<a name="l00637"></a>00637           <a class="code" href="a00024.html#beb71cd0f39604bc0a2d1365f5c3c16b">sys_clk_gen_stop</a>();
<a name="l00638"></a>00638           <a class="code" href="a00024.html#6f08d367b9ecd26d8600fd7462593c3a">wait_10_ms</a>();
<a name="l00639"></a>00639           <a class="code" href="a00016.html#628154782d795e03dc8a807545dd0622">boot_program</a>();
<a name="l00640"></a>00640           <span class="keywordflow">break</span>;
<a name="l00641"></a>00641 
<a name="l00642"></a>00642         <span class="keywordflow">default</span>:
<a name="l00643"></a>00643           <span class="keywordflow">goto</span> unsupported_request;
<a name="l00644"></a>00644         }
<a name="l00645"></a>00645         <span class="keywordflow">break</span>;
<a name="l00646"></a>00646 
<a name="l00647"></a>00647       <span class="keywordflow">default</span>:
<a name="l00648"></a>00648         <span class="keywordflow">goto</span> unsupported_request;
<a name="l00649"></a>00649       }
<a name="l00650"></a>00650       <span class="keywordflow">break</span>;
<a name="l00651"></a>00651 
<a name="l00652"></a>00652     <span class="keywordflow">case</span> <a class="code" href="a00030.html#1e1b93df0559e425c04f4d4ca2920753">CMD_GRP_SELECT</a>:
<a name="l00653"></a>00653       <span class="keywordflow">if</span> (security_active)
<a name="l00654"></a>00654       {
<a name="l00655"></a>00655         <span class="keywordflow">goto</span> unsupported_request;
<a name="l00656"></a>00656       }
<a name="l00657"></a>00657       <span class="keywordflow">switch</span> (<a class="code" href="a00030.html#4f661e7cb6f9a5ded3ac456d0ab7d319">cmd</a>)
<a name="l00658"></a>00658       {
<a name="l00659"></a>00659       <span class="keywordflow">case</span> <a class="code" href="a00030.html#91718c9f4c48630faceac10d005cbce6">CMD_SELECT_MEMORY</a>:
<a name="l00660"></a>00660         <span class="keywordflow">switch</span> (Usb_read_endpoint_data(EP_CONTROL, 8))
<a name="l00661"></a>00661         {
<a name="l00662"></a>00662         <span class="keywordflow">case</span> <a class="code" href="a00030.html#e2c20d9b274a70e96b297cbdc901fa02">CMD_SELECT_MEMORY_ARG_UNIT</a>:
<a name="l00663"></a>00663           <span class="keywordflow">switch</span> (tmp_memory = Usb_read_endpoint_data(EP_CONTROL, 8))
<a name="l00664"></a>00664           {
<a name="l00665"></a>00665           <span class="keywordflow">case</span> <a class="code" href="a00030.html#797e277b6bad54cbefc14fe6a4ef0605">MEM_FLASH</a>:
<a name="l00666"></a>00666           <span class="keywordflow">case</span> <a class="code" href="a00030.html#a9997d933806a6fb207fb55930432a00">MEM_EEPROM</a>:
<a name="l00667"></a>00667           <span class="keywordflow">case</span> <a class="code" href="a00030.html#f82d999ce5fc205a187090bfbefef388">MEM_SECURITY</a>:
<a name="l00668"></a>00668           <span class="keywordflow">case</span> <a class="code" href="a00030.html#4d3c302c0479b8044fefd249ddd501d0">MEM_CONFIGURATION</a>:
<a name="l00669"></a>00669           <span class="keywordflow">case</span> <a class="code" href="a00030.html#7312bc7c0f3695bff0b7fbc15dbb37f8">MEM_BOOTLOADER</a>:
<a name="l00670"></a>00670           <span class="keywordflow">case</span> <a class="code" href="a00030.html#81160b040a07265ec9ea9ade3480c135">MEM_SIGNATURE</a>:
<a name="l00671"></a>00671           <span class="keywordflow">case</span> <a class="code" href="a00030.html#1168f49bb6b4954943fba4baa4a6ea8f">MEM_USER</a>:
<a name="l00672"></a>00672             <a class="code" href="a00030.html#374fbbe1cfcd927515a99f5cdfc3dee7">memory</a> = tmp_memory;
<a name="l00673"></a>00673             <a class="code" href="a00030.html#52058289997b205a29f0908602c345ec">end_address</a>.<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a> = <a class="code" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a>.<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a> = 0;
<a name="l00674"></a>00674             <span class="keywordflow">break</span>;
<a name="l00675"></a>00675 
<a name="l00676"></a>00676           <span class="keywordflow">default</span>:
<a name="l00677"></a>00677             <a class="code" href="a00030.html#72b5d479cbc5c21ca31a3b96d758385f">dfu_status</a> = <a class="code" href="a00031.html#e32f24e7d30d446dd9f487f4d5e55742">STATUS_errADDRESS</a>;
<a name="l00678"></a>00678           }
<a name="l00679"></a>00679           <span class="keywordflow">break</span>;
<a name="l00680"></a>00680 
<a name="l00681"></a>00681         <span class="keywordflow">case</span> <a class="code" href="a00030.html#786167bf73a3c317633a5a89a734b13e">CMD_SELECT_MEMORY_ARG_PAGE</a>:
<a name="l00682"></a>00682           MSB(tmp_page) = Usb_read_endpoint_data(EP_CONTROL, 8);
<a name="l00683"></a>00683           LSB(tmp_page) = Usb_read_endpoint_data(EP_CONTROL, 8);
<a name="l00684"></a>00684           <span class="keywordflow">if</span> (tmp_page &lt;= <a class="code" href="a00030.html#fa623b1048e8537f6aa02080171aea63">MEMORY_END_ADDRESS</a>[<a class="code" href="a00030.html#374fbbe1cfcd927515a99f5cdfc3dee7">memory</a>].page)
<a name="l00685"></a>00685           {
<a name="l00686"></a>00686             <a class="code" href="a00030.html#52058289997b205a29f0908602c345ec">end_address</a>.<a class="code" href="a00001.html#5a3f76da8245f4f59dfcaec88659f90c">page</a> = <a class="code" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a>.<a class="code" href="a00001.html#5a3f76da8245f4f59dfcaec88659f90c">page</a> = tmp_page;
<a name="l00687"></a>00687           }
<a name="l00688"></a>00688           <span class="keywordflow">else</span> <a class="code" href="a00030.html#72b5d479cbc5c21ca31a3b96d758385f">dfu_status</a> = <a class="code" href="a00031.html#e32f24e7d30d446dd9f487f4d5e55742">STATUS_errADDRESS</a>;
<a name="l00689"></a>00689           <span class="keywordflow">break</span>;
<a name="l00690"></a>00690 
<a name="l00691"></a>00691         <span class="keywordflow">default</span>:
<a name="l00692"></a>00692           <span class="keywordflow">goto</span> unsupported_request;
<a name="l00693"></a>00693         }
<a name="l00694"></a>00694         <span class="keywordflow">break</span>;
<a name="l00695"></a>00695 
<a name="l00696"></a>00696       <span class="keywordflow">default</span>:
<a name="l00697"></a>00697         <span class="keywordflow">goto</span> unsupported_request;
<a name="l00698"></a>00698       }
<a name="l00699"></a>00699       <span class="keywordflow">break</span>;
<a name="l00700"></a>00700 
<a name="l00701"></a>00701     <span class="keywordflow">default</span>:
<a name="l00702"></a>00702 unsupported_request:
<a name="l00703"></a>00703       <a class="code" href="a00030.html#72b5d479cbc5c21ca31a3b96d758385f">dfu_status</a> = <a class="code" href="a00031.html#ff7b3e2c3070cd0238186033151c4796">STATUS_errSTALLEDPKT</a>;
<a name="l00704"></a>00704     }
<a name="l00705"></a>00705 
<a name="l00706"></a>00706     Usb_ack_control_out_received_free();
<a name="l00707"></a>00707   }
<a name="l00708"></a>00708 
<a name="l00709"></a>00709   <a class="code" href="a00030.html#dab58f74f165f09a20d44012d0e5b701">usb_dfu_status</a> = <a class="code" href="a00030.html#72b5d479cbc5c21ca31a3b96d758385f">dfu_status</a>;
<a name="l00710"></a>00710   <span class="keywordflow">if</span> (<a class="code" href="a00030.html#dab58f74f165f09a20d44012d0e5b701">usb_dfu_status</a> != <a class="code" href="a00031.html#2403320c41f08e7567cb169de5db66b3">STATUS_OK</a> &amp;&amp;
<a name="l00711"></a>00711       <a class="code" href="a00030.html#dab58f74f165f09a20d44012d0e5b701">usb_dfu_status</a> != <a class="code" href="a00031.html#bef4e4e1a2737dec9c0e1412b66b7636">STATUS_errCHECK_ERASED</a>) <span class="keywordflow">return</span> FALSE;
<a name="l00712"></a>00712 
<a name="l00713"></a>00713   Usb_ack_control_in_ready_send();
<a name="l00714"></a>00714   <span class="keywordflow">while</span> (!Is_usb_control_in_ready());
<a name="l00715"></a>00715   <span class="keywordflow">return</span> TRUE;
<a name="l00716"></a>00716 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="62dbc4daf5f5254dc94c0b1c00ae1979"></a><!-- doxytag: member="usb_dfu.c::usb_dfu_init" ref="62dbc4daf5f5254dc94c0b1c00ae1979" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void usb_dfu_init           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00493">493</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
References <a class="el" href="a00045.html#l00075">flashc_get_flash_size()</a>, <a class="el" href="a00045.html#l00301">flashc_is_security_bit_active()</a>, <a class="el" href="a00055.html#l00168">address_t::long_address</a>, <a class="el" href="a00055.html#l00121">MEM_FLASH</a>, <a class="el" href="a00055.html#l00190">MEMORY_END_ADDRESS</a>, <a class="el" href="a00055.html#l00135">PRODUCT_ID_ADDRESS</a>, <a class="el" href="a00055.html#l00177">PRODUCT_INF</a>, and <a class="el" href="a00055.html#l00136">PRODUCT_REVISION_ADDRESS</a>.
<p>
Referenced by <a class="el" href="a00049.html#l00194">main()</a>.<div class="fragment"><pre class="fragment"><a name="l00494"></a>00494 {
<a name="l00495"></a>00495   <a class="code" href="a00030.html#52ebe39948f0519a749b834767124cad">PRODUCT_INF</a>[<a class="code" href="a00030.html#e38961fa867d62efaf9fd7b35a6c9831">PRODUCT_ID_ADDRESS</a>] =
<a name="l00496"></a>00496     Rd_bitfield(Get_system_register(AVR32_CONFIG0), AVR32_CONFIG0_PROCESSORID_MASK);
<a name="l00497"></a>00497   <a class="code" href="a00030.html#52ebe39948f0519a749b834767124cad">PRODUCT_INF</a>[<a class="code" href="a00030.html#6bcaecfc51c7d24e73cfecb15dbfbeaa">PRODUCT_REVISION_ADDRESS</a>] =
<a name="l00498"></a>00498     Rd_bitfield(Get_system_register(AVR32_CONFIG0), AVR32_CONFIG0_PROCESSORREVISION_MASK);
<a name="l00499"></a>00499 
<a name="l00500"></a>00500   <a class="code" href="a00030.html#fa623b1048e8537f6aa02080171aea63">MEMORY_END_ADDRESS</a>[<a class="code" href="a00030.html#797e277b6bad54cbefc14fe6a4ef0605">MEM_FLASH</a>].<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a> = <a class="code" href="a00020.html#8071c315b02d038c49fa0bf89a40ba1b">flashc_get_flash_size</a>() - 1;
<a name="l00501"></a>00501 
<a name="l00502"></a>00502   <a class="code" href="a00030.html#2361500f6c05783fa72cb2054c93e3f0">security_active</a> = <a class="code" href="a00020.html#03df73f0be08f7bc503f3c336b1abdc1">flashc_is_security_bit_active</a>();
<a name="l00503"></a>00503 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="4ea17de3f3e93df51ea8f68aa9ca5f9f"></a><!-- doxytag: member="usb_dfu.c::usb_dfu_stop" ref="4ea17de3f3e93df51ea8f68aa9ca5f9f" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void usb_dfu_stop           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00506">506</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
References <a class="el" href="a00055.html#l00308">force_isp()</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.<div class="fragment"><pre class="fragment"><a name="l00507"></a>00507 {
<a name="l00508"></a>00508   <a class="code" href="a00030.html#5d28db34d36ff3888f49976e45f9ebd1">force_isp</a>(FALSE);
<a name="l00509"></a>00509 
<a name="l00510"></a>00510   Usb_ack_control_out_received_free();
<a name="l00511"></a>00511   Usb_ack_control_in_ready_send();
<a name="l00512"></a>00512 
<a name="l00513"></a>00513   <span class="keywordflow">while</span> (!Is_usb_setup_received());
<a name="l00514"></a>00514   Usb_ack_setup_received_free();
<a name="l00515"></a>00515   Usb_ack_control_in_ready_send();
<a name="l00516"></a>00516 
<a name="l00517"></a>00517   <span class="keywordflow">while</span> (!Is_usb_control_in_ready());
<a name="l00518"></a>00518 
<a name="l00519"></a>00519   Disable_global_interrupt();
<a name="l00520"></a>00520   Usb_disable();
<a name="l00521"></a>00521   (void)Is_usb_enabled();
<a name="l00522"></a>00522   Enable_global_interrupt();
<a name="l00523"></a>00523   Usb_disable_otg_pad();
<a name="l00524"></a>00524 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="e699cfe7ed5c0b528f080d5e056a1503"></a><!-- doxytag: member="usb_dfu.c::usb_dfu_upload" ref="e699cfe7ed5c0b528f080d5e056a1503" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Bool usb_dfu_upload           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Management of the DFU_UPLOAD requests. 
<p>

<p>
Definition at line <a class="el" href="a00055.html#l00721">721</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
References <a class="el" href="a00055.html#l00100">CMD_BLANK_CHECK</a>, <a class="el" href="a00055.html#l00091">CMD_GRP_UPLOAD</a>, <a class="el" href="a00055.html#l00099">CMD_READ_MEMORY</a>, <a class="el" href="a00055.html#l00083">dfu_format_mcu_to_dfu_data</a>, <a class="el" href="a00055.html#l00172">address_t::page_offset</a>, <a class="el" href="a00055.html#l00428">read_mem()</a>, <a class="el" href="a00055.html#l00292">start_address</a>, <a class="el" href="a00056.html#l00069">STATUS_errCHECK_ERASED</a>, <a class="el" href="a00056.html#l00079">STATUS_errSTALLEDPKT</a>, and <a class="el" href="a00056.html#l00064">STATUS_OK</a>.
<p>
Referenced by <a class="el" href="a00057.html#l00087">usb_user_read_request()</a>.<div class="fragment"><pre class="fragment"><a name="l00722"></a>00722 {
<a name="l00723"></a>00723   Usb_ack_setup_received_free();
<a name="l00724"></a>00724   Usb_reset_endpoint_fifo_access(EP_CONTROL);
<a name="l00725"></a>00725 
<a name="l00726"></a>00726   <span class="keywordflow">if</span> (<a class="code" href="a00030.html#10507ab3bbf2da5fef97e2c2d55a1bef">cmd_group</a> == <a class="code" href="a00030.html#3e7061dc18462050457e33662f885f63">CMD_GRP_UPLOAD</a> &amp;&amp;
<a name="l00727"></a>00727       (<a class="code" href="a00030.html#72b5d479cbc5c21ca31a3b96d758385f">dfu_status</a> == <a class="code" href="a00031.html#2403320c41f08e7567cb169de5db66b3">STATUS_OK</a> ||
<a name="l00728"></a>00728        <a class="code" href="a00030.html#72b5d479cbc5c21ca31a3b96d758385f">dfu_status</a> == <a class="code" href="a00031.html#bef4e4e1a2737dec9c0e1412b66b7636">STATUS_errCHECK_ERASED</a>))
<a name="l00729"></a>00729   {
<a name="l00730"></a>00730     <span class="keywordflow">switch</span> (<a class="code" href="a00030.html#4f661e7cb6f9a5ded3ac456d0ab7d319">cmd</a>)
<a name="l00731"></a>00731     {
<a name="l00732"></a>00732     <span class="keywordflow">case</span> <a class="code" href="a00030.html#929b607d33ea7317ece0130f4bd7dea9">CMD_READ_MEMORY</a>:
<a name="l00733"></a>00733       <a class="code" href="a00030.html#c47b9a242f66117db14205a3d75b6c0c">read_mem</a>();
<a name="l00734"></a>00734       <span class="keywordflow">break</span>;
<a name="l00735"></a>00735 
<a name="l00736"></a>00736     <span class="keywordflow">case</span> <a class="code" href="a00030.html#de21f96609d5cf42318df9b16c4ced73">CMD_BLANK_CHECK</a>:
<a name="l00737"></a>00737       Usb_write_endpoint_data(EP_CONTROL, 16, <a class="code" href="a00030.html#7a1cd9007045ae21acde0b48f7bdd9af">dfu_format_mcu_to_dfu_data</a>(16, <a class="code" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a>.<a class="code" href="a00001.html#7db971aec662548d8c5f3620b0ee7549">page_offset</a>));
<a name="l00738"></a>00738       <span class="keywordflow">break</span>;
<a name="l00739"></a>00739 
<a name="l00740"></a>00740     <span class="keywordflow">default</span>:
<a name="l00741"></a>00741       <span class="keywordflow">goto</span> unsupported_request;
<a name="l00742"></a>00742     }
<a name="l00743"></a>00743   }
<a name="l00744"></a>00744   <span class="keywordflow">else</span>
<a name="l00745"></a>00745   {
<a name="l00746"></a>00746 unsupported_request:
<a name="l00747"></a>00747     <a class="code" href="a00030.html#72b5d479cbc5c21ca31a3b96d758385f">dfu_status</a> = <a class="code" href="a00031.html#ff7b3e2c3070cd0238186033151c4796">STATUS_errSTALLEDPKT</a>;
<a name="l00748"></a>00748   }
<a name="l00749"></a>00749 
<a name="l00750"></a>00750   <a class="code" href="a00030.html#dab58f74f165f09a20d44012d0e5b701">usb_dfu_status</a> = <a class="code" href="a00030.html#72b5d479cbc5c21ca31a3b96d758385f">dfu_status</a>;
<a name="l00751"></a>00751   <span class="keywordflow">if</span> (<a class="code" href="a00030.html#dab58f74f165f09a20d44012d0e5b701">usb_dfu_status</a> != <a class="code" href="a00031.html#2403320c41f08e7567cb169de5db66b3">STATUS_OK</a> &amp;&amp;
<a name="l00752"></a>00752       <a class="code" href="a00030.html#dab58f74f165f09a20d44012d0e5b701">usb_dfu_status</a> != <a class="code" href="a00031.html#bef4e4e1a2737dec9c0e1412b66b7636">STATUS_errCHECK_ERASED</a>) <span class="keywordflow">return</span> FALSE;
<a name="l00753"></a>00753 
<a name="l00754"></a>00754   <span class="keywordflow">if</span> (Usb_byte_count(EP_CONTROL)) Usb_ack_control_in_ready_send();
<a name="l00755"></a>00755   <span class="keywordflow">while</span> (!Is_usb_control_out_received());
<a name="l00756"></a>00756   Usb_ack_control_out_received_free();
<a name="l00757"></a>00757   <span class="keywordflow">return</span> TRUE;
<a name="l00758"></a>00758 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="d32db56ce57a924629571ebbb28066f0"></a><!-- doxytag: member="usb_dfu.c::write_mem" ref="d32db56ce57a924629571ebbb28066f0" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void write_mem           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00454">454</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
References <a class="el" href="a00043.html#l00113">DFU_FRAME_LENGTH</a>, <a class="el" href="a00054.html#l00080">EP_CONTROL_LENGTH</a>, <a class="el" href="a00055.html#l00168">address_t::long_address</a>, <a class="el" href="a00030.html#25bcfc8e0357e922449012b0d41e30c7">MEMORY_ACCESS</a>, and <a class="el" href="a00055.html#l00292">start_address</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.<div class="fragment"><pre class="fragment"><a name="l00455"></a>00455 {
<a name="l00456"></a>00456   <span class="keywordtype">void</span> *frame;
<a name="l00457"></a>00457   U32 frame_bytes, unaligned_frame_bytes;
<a name="l00458"></a>00458 
<a name="l00459"></a>00459   <a class="code" href="a00030.html#0aa37fb76bd78e4b768975044d4e5eac">data_bytes</a> += Get_align(<a class="code" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a>.<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a>, <a class="code" href="a00029.html#99b82823fa543aebb1e28f571c5e790a">EP_CONTROL_LENGTH</a>);
<a name="l00460"></a>00460   <a class="code" href="a00030.html#2f00e80c587129859a23d409c849cb9d">length</a> -= <a class="code" href="a00029.html#99b82823fa543aebb1e28f571c5e790a">EP_CONTROL_LENGTH</a> + Align_up(<a class="code" href="a00030.html#0aa37fb76bd78e4b768975044d4e5eac">data_bytes</a>, <a class="code" href="a00029.html#99b82823fa543aebb1e28f571c5e790a">EP_CONTROL_LENGTH</a>);
<a name="l00461"></a>00461 
<a name="l00462"></a>00462   <span class="keywordflow">while</span> (<a class="code" href="a00030.html#0aa37fb76bd78e4b768975044d4e5eac">data_bytes</a>)
<a name="l00463"></a>00463   {
<a name="l00464"></a>00464     frame = <a class="code" href="a00030.html#80a3547e13a5115ed61c1e6001bddb35">dfu_frame</a>;
<a name="l00465"></a>00465     frame_bytes = min(<a class="code" href="a00030.html#0aa37fb76bd78e4b768975044d4e5eac">data_bytes</a>, <a class="code" href="a00018.html#3c4a332b7664e9c52426f821437df86e">DFU_FRAME_LENGTH</a>);
<a name="l00466"></a>00466     unaligned_frame_bytes = frame_bytes - Get_align(<a class="code" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a>.<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a>, <a class="code" href="a00029.html#99b82823fa543aebb1e28f571c5e790a">EP_CONTROL_LENGTH</a>);
<a name="l00467"></a>00467     <a class="code" href="a00030.html#0aa37fb76bd78e4b768975044d4e5eac">data_bytes</a> -= frame_bytes;
<a name="l00468"></a>00468 
<a name="l00469"></a>00469     <span class="keywordflow">while</span> (frame_bytes)
<a name="l00470"></a>00470     {
<a name="l00471"></a>00471       <span class="keywordflow">while</span> (!Is_usb_control_out_received());
<a name="l00472"></a>00472 
<a name="l00473"></a>00473       Usb_reset_endpoint_fifo_access(EP_CONTROL);
<a name="l00474"></a>00474       frame_bytes = usb_read_ep_rxpacket(EP_CONTROL, frame, frame_bytes, &amp;frame);
<a name="l00475"></a>00475       Usb_ack_control_out_received_free();
<a name="l00476"></a>00476     }
<a name="l00477"></a>00477 
<a name="l00478"></a>00478     <a class="code" href="a00030.html#25bcfc8e0357e922449012b0d41e30c7">MEMORY_ACCESS</a>[<a class="code" href="a00030.html#374fbbe1cfcd927515a99f5cdfc3dee7">memory</a>].write(<a class="code" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a>.<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a>,
<a name="l00479"></a>00479                                 <a class="code" href="a00030.html#80a3547e13a5115ed61c1e6001bddb35">dfu_frame</a> + Get_align(<a class="code" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a>.<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a>, <a class="code" href="a00029.html#99b82823fa543aebb1e28f571c5e790a">EP_CONTROL_LENGTH</a>),
<a name="l00480"></a>00480                                 unaligned_frame_bytes);
<a name="l00481"></a>00481     <a class="code" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a>.<a class="code" href="a00001.html#ed0dac19c4b2093be47ed2dceab2a437">long_address</a> += unaligned_frame_bytes;
<a name="l00482"></a>00482   }
<a name="l00483"></a>00483 
<a name="l00484"></a>00484   <span class="keywordflow">while</span> (<a class="code" href="a00030.html#2f00e80c587129859a23d409c849cb9d">length</a> &gt; 0)
<a name="l00485"></a>00485   {
<a name="l00486"></a>00486     <span class="keywordflow">while</span> (!Is_usb_control_out_received());
<a name="l00487"></a>00487     Usb_ack_control_out_received_free();
<a name="l00488"></a>00488     <a class="code" href="a00030.html#2f00e80c587129859a23d409c849cb9d">length</a> -= <a class="code" href="a00029.html#99b82823fa543aebb1e28f571c5e790a">EP_CONTROL_LENGTH</a>;
<a name="l00489"></a>00489   }
<a name="l00490"></a>00490 }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="4f661e7cb6f9a5ded3ac456d0ab7d319"></a><!-- doxytag: member="usb_dfu.c::cmd" ref="4f661e7cb6f9a5ded3ac456d0ab7d319" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U8 <a class="el" href="a00030.html#4f661e7cb6f9a5ded3ac456d0ab7d319">cmd</a> = CMD_START_APPLI<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00290">290</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
</div>
</div><p>
<a class="anchor" name="10507ab3bbf2da5fef97e2c2d55a1bef"></a><!-- doxytag: member="usb_dfu.c::cmd_group" ref="10507ab3bbf2da5fef97e2c2d55a1bef" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U8 <a class="el" href="a00030.html#10507ab3bbf2da5fef97e2c2d55a1bef">cmd_group</a> = CMD_GRP_EXEC<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00289">289</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
</div>
</div><p>
<a class="anchor" name="0aa37fb76bd78e4b768975044d4e5eac"></a><!-- doxytag: member="usb_dfu.c::data_bytes" ref="0aa37fb76bd78e4b768975044d4e5eac" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U32 <a class="el" href="a00030.html#0aa37fb76bd78e4b768975044d4e5eac">data_bytes</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00294">294</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
</div>
</div><p>
<a class="anchor" name="80a3547e13a5115ed61c1e6001bddb35"></a><!-- doxytag: member="usb_dfu.c::dfu_frame" ref="80a3547e13a5115ed61c1e6001bddb35" args="[DFU_FRAME_LENGTH]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U8 <a class="el" href="a00030.html#80a3547e13a5115ed61c1e6001bddb35">dfu_frame</a>[DFU_FRAME_LENGTH]<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00295">295</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
</div>
</div><p>
<a class="anchor" name="72b5d479cbc5c21ca31a3b96d758385f"></a><!-- doxytag: member="usb_dfu.c::dfu_status" ref="72b5d479cbc5c21ca31a3b96d758385f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U8 <a class="el" href="a00030.html#72b5d479cbc5c21ca31a3b96d758385f">dfu_status</a> = STATUS_OK<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00296">296</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
</div>
</div><p>
<a class="anchor" name="52058289997b205a29f0908602c345ec"></a><!-- doxytag: member="usb_dfu.c::end_address" ref="52058289997b205a29f0908602c345ec" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00001.html">address_t</a> <a class="el" href="a00030.html#52058289997b205a29f0908602c345ec">end_address</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00293">293</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00314">get_and_check_mem_range()</a>, and <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="3313a5dc7ce36317cfeb9d5231b22a5e"></a><!-- doxytag: member="usb_dfu.c::ISP_INF" ref="3313a5dc7ce36317cfeb9d5231b22a5e" args="[ISP_INF_ITEM_COUNT]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const U8 <a class="el" href="a00030.html#3313a5dc7ce36317cfeb9d5231b22a5e">ISP_INF</a>[ISP_INF_ITEM_COUNT]<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment">
{
  <a class="code" href="a00018.html#a95a6a7f2697bf31f411b5a63b903f6a">ISP_VERSION</a>,
  <a class="code" href="a00018.html#9642332647a8038568216fe115c1d997">ISP_ID0</a>,
  <a class="code" href="a00018.html#97ac84b28696a7ad18b1baf58e1ac969">ISP_ID1</a>
}
</pre></div>
<p>
Definition at line <a class="el" href="a00055.html#l00183">183</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00378">mem_bootloader_read()</a>.
</div>
</div><p>
<a class="anchor" name="2f00e80c587129859a23d409c849cb9d"></a><!-- doxytag: member="usb_dfu.c::length" ref="2f00e80c587129859a23d409c849cb9d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">S32 <a class="el" href="a00030.html#2f00e80c587129859a23d409c849cb9d">length</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00288">288</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
</div>
</div><p>
<a class="anchor" name="374fbbe1cfcd927515a99f5cdfc3dee7"></a><!-- doxytag: member="usb_dfu.c::memory" ref="374fbbe1cfcd927515a99f5cdfc3dee7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U8 <a class="el" href="a00030.html#374fbbe1cfcd927515a99f5cdfc3dee7">memory</a> = MEM_FLASH<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00291">291</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
</div>
</div><p>
<a class="anchor" name="25bcfc8e0357e922449012b0d41e30c7"></a><!-- doxytag: member="usb_dfu.c::MEMORY_ACCESS" ref="25bcfc8e0357e922449012b0d41e30c7" args="[MEM_COUNT]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct { ... }   <a class="el" href="a00030.html#25bcfc8e0357e922449012b0d41e30c7">MEMORY_ACCESS</a>[MEM_COUNT]<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Referenced by <a class="el" href="a00055.html#l00402">erase_check_mem()</a>, <a class="el" href="a00055.html#l00428">read_mem()</a>, <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>, and <a class="el" href="a00055.html#l00454">write_mem()</a>.
</div>
</div><p>
<a class="anchor" name="fa623b1048e8537f6aa02080171aea63"></a><!-- doxytag: member="usb_dfu.c::MEMORY_END_ADDRESS" ref="fa623b1048e8537f6aa02080171aea63" args="[MEM_COUNT]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00001.html">address_t</a> <a class="el" href="a00030.html#fa623b1048e8537f6aa02080171aea63">MEMORY_END_ADDRESS</a>[MEM_COUNT]<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment">
{
  
  {AVR32_FLASH_SIZE - 1},

  
  {0},

  
  {0},

  
  {31},

  
  {<span class="keyword">sizeof</span>(<a class="code" href="a00030.html#3313a5dc7ce36317cfeb9d5231b22a5e">ISP_INF</a>) - 1},

  
  {<span class="keyword">sizeof</span>(<a class="code" href="a00030.html#52ebe39948f0519a749b834767124cad">PRODUCT_INF</a>) - 1},

  
  {AVR32_FLASHC_USER_PAGE_SIZE - 1}
}
</pre></div>
<p>
Definition at line <a class="el" href="a00055.html#l00190">190</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00314">get_and_check_mem_range()</a>, <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>, and <a class="el" href="a00055.html#l00493">usb_dfu_init()</a>.
</div>
</div><p>
<a class="anchor" name="28dba1152c71ba300f1583f994d66682"></a><!-- doxytag: member="usb_dfu.c::MEMORY_ERASE_VALUE" ref="28dba1152c71ba300f1583f994d66682" args="[MEM_COUNT]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const U8 <a class="el" href="a00030.html#28dba1152c71ba300f1583f994d66682">MEMORY_ERASE_VALUE</a>[MEM_COUNT]<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment">
{
  
  0xFF,

  
  0xFF,

  
  0x00,

  
  0x01,

  
  0x00,

  
  0x00,

  
  0xFF
}
</pre></div>
<p>
Definition at line <a class="el" href="a00055.html#l00263">263</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
</div>
</div><p>
<a class="anchor" name="52ebe39948f0519a749b834767124cad"></a><!-- doxytag: member="usb_dfu.c::PRODUCT_INF" ref="52ebe39948f0519a749b834767124cad" args="[PRODUCT_INF_ITEM_COUNT]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U8 <a class="el" href="a00030.html#52ebe39948f0519a749b834767124cad">PRODUCT_INF</a>[PRODUCT_INF_ITEM_COUNT]<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment">
{
  <a class="code" href="a00018.html#964f1eba0964c2e79405d8914d4370f0">PRODUCT_MANUFACTURER_ID</a>,
  <a class="code" href="a00018.html#0863e98b6e09296044e33bc44e39b7a2">PRODUCT_FAMILY_ID</a>
}
</pre></div>
<p>
Definition at line <a class="el" href="a00055.html#l00177">177</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00384">mem_signature_read()</a>, and <a class="el" href="a00055.html#l00493">usb_dfu_init()</a>.
</div>
</div><p>
<a class="anchor" name="2ee0f257169fa94a36a103b84afa7101"></a><!-- doxytag: member="usb_dfu.c::read" ref="2ee0f257169fa94a36a103b84afa7101" args=")(void *dst, U32 src, size_t nbytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="a00030.html#2ee0f257169fa94a36a103b84afa7101">read</a>)(void *dst, U32 src, size_t nbytes)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<a class="anchor" name="2361500f6c05783fa72cb2054c93e3f0"></a><!-- doxytag: member="usb_dfu.c::security_active" ref="2361500f6c05783fa72cb2054c93e3f0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Bool <a class="el" href="a00030.html#2361500f6c05783fa72cb2054c93e3f0">security_active</a> = TRUE<code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00287">287</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
</div>
</div><p>
<a class="anchor" name="4442c564b99c01cf95a13195118b3a79"></a><!-- doxytag: member="usb_dfu.c::start_address" ref="4442c564b99c01cf95a13195118b3a79" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00001.html">address_t</a> <a class="el" href="a00030.html#4442c564b99c01cf95a13195118b3a79">start_address</a><code> [static]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00292">292</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00055.html#l00402">erase_check_mem()</a>, <a class="el" href="a00055.html#l00314">get_and_check_mem_range()</a>, <a class="el" href="a00055.html#l00428">read_mem()</a>, <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>, <a class="el" href="a00055.html#l00721">usb_dfu_upload()</a>, and <a class="el" href="a00055.html#l00454">write_mem()</a>.
</div>
</div><p>
<a class="anchor" name="ab5b7c0a4e01dcfaa3985722d933afbe"></a><!-- doxytag: member="usb_dfu.c::usb_dfu_state" ref="ab5b7c0a4e01dcfaa3985722d933afbe" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U8 <a class="el" href="a00031.html#ab5b7c0a4e01dcfaa3985722d933afbe">usb_dfu_state</a> = STATE_dfuIDLE          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00299">299</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00057.html#l00087">usb_user_read_request()</a>.
</div>
</div><p>
<a class="anchor" name="dab58f74f165f09a20d44012d0e5b701"></a><!-- doxytag: member="usb_dfu.c::usb_dfu_status" ref="dab58f74f165f09a20d44012d0e5b701" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">U8 <a class="el" href="a00031.html#dab58f74f165f09a20d44012d0e5b701">usb_dfu_status</a> = STATUS_OK          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Definition at line <a class="el" href="a00055.html#l00298">298</a> of file <a class="el" href="a00055.html">usb_dfu.c</a>.
<p>
Referenced by <a class="el" href="a00057.html#l00087">usb_user_read_request()</a>.
</div>
</div><p>
<a class="anchor" name="76c4ac28168870c768186fd58667751c"></a><!-- doxytag: member="usb_dfu.c::write" ref="76c4ac28168870c768186fd58667751c" args=")(U32 dst, const void *src, size_t nbytes)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void(* <a class="el" href="a00030.html#76c4ac28168870c768186fd58667751c">write</a>)(U32 dst, const void *src, size_t nbytes)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
Referenced by <a class="el" href="a00055.html#l00529">usb_dfu_dnload()</a>.
</div>
</div><p>
<hr size="1"><address style="align: right;"><small>Generated on Thu Sep 20 12:17:25 2007 for AVR32 - USB DFU Example: ISP by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1-p1 </small></address>
</body>
</html>
